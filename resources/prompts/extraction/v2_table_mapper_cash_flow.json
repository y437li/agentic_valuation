{
    "id": "extraction.table_mapper.cash_flow",
    "name": "Cash Flow Statement Table Mapper",
    "category": "extraction",
    "description": "Maps Cash Flow Statement line items to FSAP variables. Returns row indices and mappings, NOT values.",
    "version": "2.1.0",
    "architecture": "LLM_NAVIGATOR_GO_EXTRACTOR",
    "system_prompt": "You are a Financial Data Analyst. Your job is to MAP line items in a financial table to standard FSAP variables.\n\nIMPORTANT RULES:\n1. You are NOT extracting values. You are only MAPPING rows to variable names.\n2. SKIP header rows - rows where the first column is empty or contains only dates.\n3. Only map rows that have a TEXT LABEL in the first column.\n4. row_index is 0-based, starting from the FIRST DATA ROW with a text label.\n5. For year_columns, extract the YEAR from date headers (e.g., \"Sep. 28, 2024\" -> year: 2024).",
    "user_prompt_template": "Map line items in this CASH FLOW STATEMENT table to FSAP variables.\n\nTABLE:\n{{.TableMarkdown}}\n\nIMPORTANT: Tables may have multi-row headers. For example:\n| Title | 12 Months Ended |   |   |\n| --- | --- | --- | --- |\n|   | Sep. 28, 2024 | Sep. 30, 2023 | Sep. 24, 2022 |  <- This is a SUB-HEADER row, SKIP IT\n| Net income | 93736 | 96995 | 99803 |                  <- This is the FIRST DATA ROW (row_index: 0)\n\nExtract years from dates: \"Sep. 28, 2024\" -> year: 2024\n\nFSAP VARIABLES TO MAP:\n\n=== OPERATING ACTIVITIES (parent_section: \"operating_activities_section\") ===\n- net_income_start: Net income (starting point)\n- depreciation_amortization: Depreciation and amortization\n- stock_based_compensation: Stock-based compensation expense\n- operating_cash_flow: [SUBTOTAL] Net cash from/generated by operating activities\n\n=== INVESTING ACTIVITIES (parent_section: \"investing_activities_section\") ===\n- capex: Capital expenditures, purchases of PP&E\n- purchases_investments: Purchases of investments/marketable securities\n- sales_investments: Sales/maturities of investments\n- investing_cash_flow: [SUBTOTAL] Net cash from investing activities\n\n=== FINANCING ACTIVITIES (parent_section: \"financing_activities_section\") ===\n- debt_repayment: Repayment of debt\n- stock_repurchase: Repurchases of common stock\n- dividends_paid: Dividends paid\n- financing_cash_flow: [SUBTOTAL] Net cash from/used in financing activities\n\n=== RECONCILIATION (parent_section: \"reconciliation_section\") ===\n- net_change_cash: [TOTAL] Net increase/decrease in cash\n- cash_beginning: Cash at beginning of period\n- cash_ending: [TOTAL] Cash at end of period\n\nFor items NOT matching standard fields, use fsap_variable: \"UNIQUE\".\n\nOutput JSON:\n{\n  \"table_type\": \"cash_flow\",\n  \"year_columns\": [{\"year\": 2024, \"column_index\": 1}, {\"year\": 2023, \"column_index\": 2}, {\"year\": 2022, \"column_index\": 3}],\n  \"row_mappings\": [\n    {\n      \"row_index\": 0,\n      \"row_label\": \"Net income\",\n      \"fsap_variable\": \"net_income_start\",\n      \"item_type\": \"ITEM\",\n      \"parent_section\": \"operating_activities_section\",\n      \"confidence\": 1.0\n    }\n  ]\n}",
    "response_schema_ref": "line_item_mapping",
    "variables": [
        {
            "name": "TableMarkdown",
            "type": "string",
            "description": "Markdown table content to map",
            "required": true
        }
    ]
}