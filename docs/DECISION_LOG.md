# TIED Project Decision Log (Transaction Record)

This document serves as the immutable "Transaction Log" of key architectural, product, and strategic decisions for the TIED platform.
**Agent Instruction**: Before proposing major changes, check this log to ensure consistency with prior decisions. When a new key decision is agreed upon, append it here.

| ID | Date | Category | Decision | Rationale (Why) | Status |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **TX-001** | 2026-01-17 | **Branding** | **Project Renamed to "TIED"** | To reflect the core pillars: **T**ransparent, **I**ntegrated, **E**vidence-**D**riven. Emphasizes that all data is "tied" to evidence. | `Active` |
| **TX-002** | 2026-01-17 | **Strategy** | **Adopt "3-Month Vibe Coding" Plan** | To compress a 1-year roadmap into 90 days by leveraging AI efficiency. Focus on "Core Engine" (Month 1), "Productization" (Month 2), "Integration" (Month 3). | `Active` |
| **TX-003** | 2026-01-17 | **Tech Stack** | **Hybrid Stack: Go + Next.js + Python** | **Go**: Financial integrity (strict types) & concurrency. **Next.js**: Modern interactive UI. **Python**: "Dirty work" like PDF parsing (independent scripts). | `Active` |
| **TX-004** | 2026-01-17 | **Database** | **Supabase (PostgreSQL) Implementation** | Need a "Hybrid Vault": Relational tables for strict metadata/financials, but `JSONB` for flexible "Explainability" & Agent reasoning. `pgvector` for evidence search. | `Active` |
| **TX-005** | 2026-01-17 | **UI/UX** | **Refactor "DCF" to Generic "Modeling"** | To support multiple valuation methodologies (Exit Multiple, Perp Growth, LBO) under a unified "Valuation Modeling" interface, avoiding DCF-centric bias. | `Implemented` |
| **TX-006** | 2026-01-17 | **Feature** | **Explainable Semantic Mapping** | Instead of black-box importing, the system must expose "Agent Reasoning" and original "Cell Coordinates" for every mapped field to build trust. | `Implemented` |
| **TX-007** | 2026-01-18 | **Tech Stack** | **Integrate JSON Repair Libraries** | To handle malformed JSON from LLM outputs. Using **hjson-go** + **json-repair** (Go) and **jsonrepair** (TypeScript) for language-native solutions, avoiding Python dependencies to maintain stack consistency. | `Implemented` |
| **TX-008** | 2026-01-18 | **Tech Stack** | **Integrate DeepSeek & Qwen Providers** | Integrated Qwen (via `openai-go` for DashScope API) and DeepSeek (via native `net/http` for flexibility) to support diverse, cost-effective LLM options. Backend API updated to support dynamic provider switching. | `Implemented` |
| **TX-009** | 2026-01-18 | **Arch** | **Delta-based Scenario Modeling** | Scenarios (Bull/Bear) only store overrides ("deltas"). Calculation uses a lookup chain: `Scenario -> Base -> Golden`. Avoids full duplication and maintains historical mapping integrity. | `Active` |
| **TX-010** | 2026-01-18 | **Database** | **One-Case-per-Company Constraint** | Enforced `UNIQUE(user_id, company_id)` on `valuation_cases`. Prevents fragmentation of context. Multiple scenarios must exist *inside* the same case. | `Implemented` |
| **TX-011** | 2026-01-18 | **Arch** | **Agent-Backend Bridge for Params**| All parameter changes by Agent must call Go REST APIs (via MCP) instead of direct DB updates. Ensures Go engine validates integrity and recalculates everything before frontend rendering. | `Active` |
| **TX-012** | 2026-01-18 | **Database** | **Pruning & Milestone Strategy** | To prevent JSONB bloat, system only keeps 20 ephemeral versions per scenario. "Milestones" are protected and kept permanently. | `Active` |
| **TX-013** | 2026-01-18 | **UI/UX** | **Data Mapping Redesign: Year-Based + Timeline** | The Data Mapping panel now organizes files and mappings by Fiscal Year. Each upload shows contained fields. Bull/Bear scenarios are only selectable in the Valuation stage, not in Mapping. | `Implemented` |
| **TX-014** | 2026-01-18 | **UI/UX** | **Landing Page & Case Workflow** | Introduced a dedicated **Case Selector Page** as the entry point. Users must search/create a company case and select Fiscal Years *before* entering the workspace. Splits "New Case" (Left Panel) and "Case History" (Right Panel) for clarity. | `Active` |
| **TX-015** | 2026-01-18 | **Branding** | **TIED Logo & Case Management** | Finalized "TIED" branding on the Case Selector. Adjusted layout to 40/60 split. Added **Delete** action for cases. Global Header now includes Snapshots & Save actions for all views. | `Implemented` |
| **TX-016** | 2026-01-20 | **UI/UX** | **Consolidated Financial Analysis Tabs** | Integrated Ratio Analysis, DuPont Analysis, Growth Rates, Beneish M-Score, and Altman Z-Score into `FinancialStatements.tsx` as separate tabs. Reduces sidebar clutter and groups related analytical views. | `Implemented` |
| **TX-017** | 2026-01-20 | **Arch** | **AnalysisPanel Embedded Mode** | `AnalysisPanel` component accepts an `embedded` prop to hide redundant headers and company info when used inside `FinancialStatements`. Uses React `lazy()` for code-splitting. | `Implemented` |
| **TX-018** | 2026-01-20 | **UI/UX** | **Minimalist Professional Styling** | Removed flashy gradients and colorful cards from AnalysisPanel and ForecastPanel. Adopted neutral gray backgrounds (`#f8fafc`), clean borders, and `rounded-lg` for consistency with banking-grade UI standards. | `Implemented` |
| **TX-019** | 2026-01-20 | **Feature** | **Sidebar Quick Navigation** | Sidebar links for analysis sections now pass `initialTab` prop to `FinancialStatements`, enabling quick jump to specific tabs while maintaining consolidated view architecture. | `Implemented` |
| **TX-020** | 2026-01-20 | **Arch** | **Dynamic Assumption Hierarchy (3-Layer)** | Assumptions have 3 layers max: Level 1 (fixed templates), Level 2 (Agent-generated segments), Level 3 (Agent-generated details). Structure generated by Segment Agent, values set by Roundtable Debate. | `Active` |
| **TX-021** | 2026-01-20 | **Arch** | **Synthesizer Unified Output** | Synthesizer Agent outputs single JSON containing both `memorandum` (Markdown) and `assumptions[]` (structured data). This is the Single Source of Truth for frontend and backend. | `Active` |
| **TX-022** | 2026-01-20 | **UX** | **Roundtable Trigger Logic** | New Case: mandatory Roundtable with progress display and Skip option. Existing Case: user-triggered [Refresh Assumptions] button only. No auto-override of existing data. | `Active` |
| **TX-023** | 2026-01-20 | **UX** | **Assumption Diff Review** | When Roundtable suggests changes to existing Case, display Diff Modal. User can Accept/Reject each change individually. New assumptions shown as "Add" option. | `Active` |
| **TX-024** | 2026-01-20 | **Arch** | **Assumption Apply/Remove Toggle** | Each assumption has `applied: boolean`. Users can toggle assumptions on/off without deleting. Only `applied=true` assumptions are included in Forecast calculations. | `Active` |

